{"version":3,"sources":["webpack://ratemycornellprofessor/./src/content.ts","webpack://ratemycornellprofessor/webpack/startup"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["/**\n * Rate My Cornell Professors\n * JavaScript file to scrape information and replace it in Class Roster\n */\n\n//import { restricted } from './restricted';\n//import { subs } from './subs';\n\n\nconst BASE_URL: string = 'http://www.ratemyprofessors.com';\nconst BASE_SEARCH_URL: string = 'http://www.ratemyprofessors.com/search.jsp?queryoption=HEADER&queryBy=teacherName&schoolName=Cornell+University&schoolID=298&query=';\nconst GREEN: string = '#1FB81C';\nconst YELLOW: string = '#FEEB00';\nconst RED: string = '#FC4433';\n// Use the same loading indicator that the page already does; don't host our own\nconst LOADING_INDICATOR: string = '<img src=\"https://i.pinimg.com/originals/a6/8f/b5/a68fb58aa1ace26b0008f5a5dbcebfd2.jpg\">';\n\n// @ts-ignore\nchrome.runtime.sendMessage({ action: 'showIcon' });\nlet area = document.getElementsByClassName('class-listing')[0]\nconsole.log(area)\n// Watch each of the areas where professor names may appear for changes. When detected, rate each professor.\n// const getOverallScoresObserver: MutationObserver = new MutationObserver(rateProfessorsOnPage);\nconst getOverallScoresObserver: MutationObserver = new MutationObserver(rateProfessorsOnPage);\nconsole.log(document.getElementsByClassName('class-listing').item(0));\n//$COURSE_LIST_AREAS.forEach(area => getOverallScoresObserver.observe(area, { childList: true }));\ngetOverallScoresObserver.observe(document.getElementsByClassName('class-listing').item(0), { childList: true, attributes: true});\n\n//rateProfessorsOnPage;\n/**\n * Rates each of the professors currently in view.\n */\nsetTimeout(rateProfessorsOnPage, 1000);\n\nfunction rateProfessorsOnPage() {\n  console.log(\"--rateProfessorsOnPage\")\n  const professorArray: Array<string> = getProfessorStrings()\n\nfor (let i:number = 0; i < professorArray.length; i++) {\n let myNode: HTMLElement = document.getElementsByClassName('instructors').item(0).querySelector('tooltip-iws')\n async name => {\n    try {\n      if (isValidProfessor(name) && isUnratedProfessor(name)) {\n        const score = await getProfessorId(name).then(getOverallScore);\n        setScore(name, myNode, score);\n      } else if (isUnratedProfessor(name)) {\n        setInvalidScore(name, myNode);\n      }\n    }finally{\n      setInvalidScore(name, myNode);\n    };\n  }\n}\n}\n\n\n/**\n * Returns an array of strings of each search result's professor field\n */\nfunction getProfessorStrings(): Array<string> {\n  let returnStrings: Array<string> = []\n  console.log(document.getElementsByClassName('instructors').length)\n  for (let i: number = 0; i < document.getElementsByClassName('instructors').length; i++) {\n    let returnVal: string = document.getElementsByClassName('instructors').item(i).getElementsByClassName('tooltip-iws').item(0).getAttribute('data-content')\n    returnVal = returnVal.substring(0, returnVal.indexOf(\" (\"))\n    console.log(returnVal)\n    returnStrings[i] = returnVal\n\n    //let returnVal: HTMLElement = document.getElementsByClassName('instructors').item(i).querySelector('tooltip-iws')\n  }\n  return returnStrings;\n}\n\n/**\n * Gets the part of the URL that needs to be appended to the base URL to reach the professor's page\n * Example return: '/ShowRatings.jsp?tid=2301025'\n */\nfunction getProfessorId(profName: string): Promise<string> {\n  const config = {\n    action: 'searchForProfessor',\n    method: 'POST',\n    url: BASE_SEARCH_URL + convertName(profName)\n  };\n\n  return new Promise((resolve, reject) => {\n    // @ts-ignore\n    chrome.runtime.sendMessage(config, res => {\n      if (res.profId) {\n        resolve(res.profId);\n      } else {\n        reject('Search result not found');\n      }\n    });\n  });\n}\n\n/**\n * Scrapes the RMP page for the professor at <profId> for their overall score and returns it\n */\nfunction getOverallScore(profId: string): Promise<number> {\n  const config = {\n    action: 'getOverallScore',\n    method: 'POST',\n    url: BASE_URL + profId,\n  };\n\n  return new Promise((resolve, reject) => {\n    // @ts-ignore\n    chrome.runtime.sendMessage(config, res => {\n      if (res.profRating) {\n        if (res.profRating === '0.0' || res.profRating.includes('Grade received')) {\n          reject('Professor not rated');\n        } else {\n          resolve(parseFloat(res.profRating));\n        }\n      } else {\n        reject('No rating found');\n      }\n    });\n  });\n}\n\n/**\n * Converts a name from it's notation as shown in the search results to a form\n * that can be appended to the base RateMyProfessors URL in order to emulate\n * a search.\n */\nfunction convertName(original: string): string {\n  const regex = /\\w+(, )\\w+/g;\n  const temp: RegExpExecArray = regex.exec(original)!;\n//   if (temp[0].trim() in subs) {\n//     temp[0] = subs[temp[0].trim()];\n//   }\n  return encodeURIComponent(temp[0]);\n}\n\n/**\n * Returns a color based on <rating>. These numbers match the values on RateMyProfessors.com\n */\nfunction getColor(rating: number): string {\n  if (rating >= 3.5) {\n    return GREEN;\n  }\n  if (rating < 2.5) {\n    return RED;\n  }\n  return YELLOW;\n}\n\n/**\n * Given an array of elements, groups them by professor name and returns an object\n * where the key represents the professor name and the value is an array of the nodes\n * that correspond to that professor.\n *\n * Slight modification of https://stackoverflow.com/questions/14446511/what-is-the-most-efficient-method-to-groupby-on-a-javascript-array-of-objects\n */\nfunction groupProfessors(vals: NodeListOf<Element>): { [key: string]: HTMLElement[] } {\n  return Array.from(vals).reduce((ret, val) => {\n    (ret[val.textContent.trim()] = ret[val.textContent.trim()] || []).push(val);\n    return ret;\n  }, {});\n}\n\n/**\n * Returns TRUE if the professor is a single, non-Staff professor. Staff professors and\n * courses with multiple professors return FALSE.\n */\nfunction isValidProfessor(name: string): boolean {\n  return (name !== '' && !name.includes('Staff'));\n}\n\n/**\n * Return TRUE if the professor is not already rated or is in the process of being rated.\n * FALSE otherwise.\n */\nfunction isUnratedProfessor(name: string): boolean {\n  return !name.includes(' - ');\n}\n\n/**\n * Adds 'N/A' as the score to professor on the search page\n */\nfunction setInvalidScore(name: string, node: HTMLElement) {\n  setScore(name, node);\n}\n\n/**\n * Appends the loading indicator next to professor names in the results list\n */\nfunction setIsLoading(name: String) {\n  //name.innerHTML = name.innerHTML + ' - ' + LOADING_INDICATOR;\n  name = name + ' - ' + LOADING_INDICATOR;\n}\n\n/**\n * Adds the score and changes the color of the professor on the search page\n */\nfunction setScore(name: string, node: HTMLElement, score?: number) {\n  if (score) {\n    node.textContent = name + ' - ' + score.toFixed(1);\n    node.style.color = getColor(score);\n  } else {\n    node.textContent = name + ' - N/A';\n  }\n}\n\n","// startup\n// Load entry module\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_modules__[\"./src/content.ts\"]();\n"],"sourceRoot":""}